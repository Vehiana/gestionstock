CREATE TABLE Categorie(
   nomCategorie VARCHAR(50) NOT NULL,
   PRIMARY KEY(nomCategorie)
);

CREATE TABLE SousCategorie(
   nomCategorie VARCHAR(50),
   nomSousCategorie VARCHAR(50) NOT NULL,
   PRIMARY KEY(nomCategorie, nomSousCategorie),
   FOREIGN KEY(nomCategorie) REFERENCES Categorie(nomCategorie)
);

CREATE TABLE Fournisseur(
   idFournisseur INT AUTO_INCREMENT,
   nomFournisseur VARCHAR(50) NOT NULL,
   PRIMARY KEY(idFournisseur)
);

CREATE TABLE Profil(
   idprofil VARCHAR(20),
   nomprofil VARCHAR(20) NOT NULL,
   PRIMARY KEY(idprofil)
);

CREATE TABLE Type(
   idType INT AUTO_INCREMENT,
   nomType VARCHAR(50) NOT NULL,
   PRIMARY KEY(idType)
);

CREATE TABLE Modele(
   idModele INT AUTO_INCREMENT,
   nomModele VARCHAR(50) NOT NULL,
   PRIMARY KEY(idModele)
);

CREATE TABLE Utilisateur(
   idUser INT AUTO_INCREMENT,
   nom VARCHAR(50) NOT NULL,
   prenom VARCHAR(50) NOT NULL,
   login VARCHAR(50) NOT NULL,
   hashed_password VARCHAR(255) NOT NULL,
   idprofil VARCHAR(20) NOT NULL,
   PRIMARY KEY(idUser),
   FOREIGN KEY(idprofil) REFERENCES Profil(idprofil)
);

CREATE TABLE Article(
   numSerie VARCHAR(50),
   dateArr DATETIME DEFAULT CURRENT_TIMESTAMP,
   dateSortie DATE NOT NULL,
   idModele INT NOT NULL,
   idType INT NOT NULL,
   nomCategorie VARCHAR(50) NOT NULL,
   nomSousCategorie VARCHAR(50) NOT NULL,
   idFournisseur INT NOT NULL,
   PRIMARY KEY(numSerie),
   FOREIGN KEY(idModele) REFERENCES Modele(idModele),
   FOREIGN KEY(idType) REFERENCES Type(idType),
   FOREIGN KEY(nomCategorie, nomSousCategorie) REFERENCES SousCategorie(nomCategorie, nomSousCategorie),
   FOREIGN KEY(idFournisseur) REFERENCES Fournisseur(idFournisseur)
);

CREATE TABLE affecter(
   idUser INT,
   numSerie VARCHAR(50),
   dateAffectation VARCHAR(50),
   PRIMARY KEY(idUser, numSerie),
   FOREIGN KEY(idUser) REFERENCES Utilisateur(idUser),
   FOREIGN KEY(numSerie) REFERENCES Article(numSerie)
);

